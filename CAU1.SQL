CONN SYS/123@//LOCALHOST:1523/ORCLDOCKER  AS  SYSDBA; 

ALTER SESSION SET "_ORACLE_SCRIPT" = TRUE ; 

DROP USER QL_NHANSU CASCADE;

-- CAU 1

CREATE USER QL_NHANSU IDENTIFIED BY 123 QUOTA UNLIMITED ON USERS ; 
GRANT ALL PRIVILEGES TO QL_NHANSU;
ALTER SESSION SET CURRENT_SCHEMA = QL_NHANSU ; 

CREATE TABLE NHANVIEN (
    MANV NVARCHAR2(5) PRIMARY KEY ,
    MAPB NVARCHAR2(5),
    CHUCVU NVARCHAR2(20) 
);

CREATE TABLE LUONG (
    MANV NVARCHAR2(5),
    THANG NUMBER,
    LUONGCB NUMBER,
    PHUCAP NUMBER,
    TONGLUONG NUMBER,
    PRIMARY KEY (MANV, THANG),
    FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV) 
);

CREATE TABLE TONGHOP (
    NAM NUMBER,
    MAPB NUMBER,
    THU NUMBER,
    CHI NUMBER,
    PRIMARY KEY (NAM, MAPB)
); 

-- THEM GIAM DOC
INSERT INTO NHANVIEN
VALUES ('NV001','PB001','GIÁM ĐỐC');

-- THEM TRUONG PHONG
INSERT INTO NHANVIEN
VALUES ('NV002','PB001','TRƯỞNG PHÒNG') ;

INSERT INTO NHANVIEN
VALUES ('NV003','PB002','TRƯỞNG PHÒNG') ;

INSERT INTO NHANVIEN
VALUES ('NV004','PB003','TRƯỞNG PHÒNG') ;

-- THEM NHAN VIEN PHONG KE TOAN
INSERT INTO NHANVIEN
SELECT 
    'NV00' || TRUNC(LEVEL+4),
    'PB001',
    'NHÂN VIÊN'
FROM DUAL
CONNECT BY LEVEL <= 5;
SELECT * FROM NHANVIEN;

INSERT INTO NHANVIEN
SELECT 
    'NV0' || TRUNC(LEVEL+9),
    'PB001',
    'NHÂN VIÊN'
FROM DUAL
CONNECT BY LEVEL <= 5;

-- THEM 15 NHAN VIEN KE HOACH 
INSERT INTO NHANVIEN
SELECT 
    'NV0' || TRUNC(LEVEL+14),
    'PB002',
    'NHÂN VIÊN'
FROM DUAL
CONNECT BY LEVEL <=15;

-- THEM 10 NHAN VIEN PHONG KY THUAT
INSERT INTO NHANVIEN
SELECT
    'NV0' || TRUNC(LEVEL+29),
    'PB003',
    'NHÂN VIÊN'
FROM DUAL
CONNECT BY LEVEL <=10;

-- KIEM TRA NHAN VIEN
SELECT * FROM NHANVIEN;

